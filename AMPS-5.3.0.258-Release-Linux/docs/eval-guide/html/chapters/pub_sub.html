<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>3. Subscribe Publish and Subscribe &#8212; Advanced Message Processing System (AMPS) Evaluation Guide 5.3.0.255
 documentation</title>
    
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '5.3.0.255',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="4. State of the World (SOW)" href="sow.html" />
    <link rel="prev" title="2. Getting Started" href="getting_started.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/flag_logo.png" alt="Logo"/>
            </a></p>
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">3. Subscribe Publish and Subscribe</a><ul>
<li><a class="reference internal" href="#topics">Topics</a><ul>
<li><a class="reference internal" href="#regular-expressions">Regular Expressions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#filtering-subscriptions-by-content">Filtering Subscriptions By Content</a><ul>
<li><a class="reference internal" href="#example-filter-for-a-json-message">Example Filter for a JSON message:</a></li>
<li><a class="reference internal" href="#example-filter-for-an-xml-message">Example Filter for an XML Message:</a></li>
<li><a class="reference internal" href="#example-filter-for-a-fix-message">Example Filter for a FIX Message:</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="getting_started.html" title="previous chapter">2. Getting Started</a></li>
      <li>Next: <a href="sow.html" title="next chapter">4. State of the World (SOW)</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="subscribe-publish-and-subscribe">
<h1>3. Subscribe Publish and Subscribe<a class="headerlink" href="#subscribe-publish-and-subscribe" title="Permalink to this headline">¶</a></h1>
<p id="index-0">AMPS is a publish and subscribe message delivery system, which routes
messages from publishers to subscribers. “Pub/Sub” systems, as they are
often called, are a key part of most enterprise message buses, where
publishers broadcast messages without necessarily knowing all of the
subscribers that will receive them. This decoupling of the publishers
from the subscribers allows maximum flexibility when adding new data
sources or consumers.</p>
<div class="figure" id="pub-sub-fig1">
<a class="reference internal image-reference" href="../_images/PubSub1.svg"><img alt="Publish and Subscribe" src="../_images/PubSub1.svg" width="75.0%" /></a>
</div>
<p><strong>Figure 3.1:</strong> <em>Publish and Subscribe</em></p>
<p>AMPS can route messages from publishers to subscribers using a topic identifier and/or content within the
message&#8217;s payload. For example, in
<a class="reference internal" href="#pub-sub-fig1"><span class="std std-ref">Figure 3.1</span></a>,
there is a Publisher sending AMPS a message pertaining to the <code class="docutils literal"><span class="pre">LN_ORDERS</span></code> topic. The message being sent
contains information on Ticker “IBM” with a Price of 125, both of these properties are contained within the
message payload itself (i.e., the message content). AMPS routes the message to Subscriber 1 because it is
subscribing to all messages on the <code class="docutils literal"><span class="pre">LN_ORDERS</span></code> topic. Similarly, AMPS
routes the message to Subscriber 2 because it is subscribed to any
messages having the Ticker equal to “IBM”. Subscriber 3 is looking for a
different Ticker value and is not sent the message.</p>
<div class="section" id="topics">
<h2>Topics<a class="headerlink" href="#topics" title="Permalink to this headline">¶</a></h2>
<p id="index-1">A topic is a string that is used to declare a subject of interest for
purposes of routing messages between publishers and subscribers.
Topic-based Publish and-Subscribe (e.g., Pub/Sub) is the simplest form
of Pub/Sub filtering. All messages are published with a topic
designation to the AMPS engine, and subscribers will receive messages
for topics to which they have subscribed.</p>
<div class="figure" id="pub-sub-fig2">
<a class="reference internal image-reference" href="../_images/PubSub2.svg"><img alt="Topic Based Pub/Sub" src="../_images/PubSub2.svg" width="75.0%" /></a>
</div>
<p><strong>Figure 3.2:</strong> <em>Topic Based Pub/Sub</em></p>
<p>For example, in <a class="reference internal" href="#pub-sub-fig2"><span class="std std-ref">Figure 3.2</span></a>, there are two publishers: Publisher
1 and Publisher 2 which publish to the topics <code class="docutils literal"><span class="pre">LN_ORDERS</span></code> and
<code class="docutils literal"><span class="pre">NY_ORDERS</span></code>, respectively. Messages published to AMPS are filtered and
routed to the subscribers of a respective topic. For example, Subscriber
1, which is subscribed to all messages for the <code class="docutils literal"><span class="pre">LN_ORDERS</span></code> topic will
receive everything published by Publisher 1. Subscriber 2, which is
subscribed to the regular expression topic <code class="docutils literal"><span class="pre">&quot;.*_ORDERS&quot;</span></code> will receive
all orders published by Publisher 1 and 2.</p>
<p>Regular expression matching makes it easy to create topic paths in AMPS.
Some messaging systems require a specific delimiter for paths. AMPS
allows you the flexibility to use any delimiter. However, 60East
recommends using characters that do not have significance in regular
expressions, such as forward slashes. For example, rather than using
<code class="docutils literal"><span class="pre">northamerica.orders</span></code> as a path, use <code class="docutils literal"><span class="pre">northamerica/orders</span></code>.</p>
<p>AMPS does not restrict the characters that can be present in a topic
name. However, notice that topic names that contain regular expression
characters (such as <code class="docutils literal"><span class="pre">.</span></code> or <code class="docutils literal"><span class="pre">*</span></code>) will be interpreted as regular
expressions by default, which may cause unexpected behavior.</p>
<p>Topics that begin with <code class="docutils literal"><span class="pre">/AMPS</span></code> are reserved. The AMPS server publishes
messages to topics that begin with <code class="docutils literal"><span class="pre">/AMPS</span></code> as described in
(EVENT_TOPICS). Some versions of the AMPS client libraries
may internally publish to <code class="docutils literal"><span class="pre">/AMPS/devnull</span></code>. Your applications should
not publish to topics that begin with <code class="docutils literal"><span class="pre">/AMPS</span></code>, and publishes to those
topics may fail.</p>
<div class="section" id="regular-expressions">
<h3>Regular Expressions<a class="headerlink" href="#regular-expressions" title="Permalink to this headline">¶</a></h3>
<p id="index-2">With AMPS, a subscriber can use a regular expression to simultaneously
subscribe to multiple topics that match the given pattern. This feature
can be used to effectively subscribe to topics without knowing the topic
names in advance. Note that the messages themselves have no notion of a
topic pattern. The topic for a given message is unambiguously specified
using a literal string. From the publisher’s point of view, it is
publishing a message to a topic; it is never publishing to a topic
pattern.</p>
<p>Subscription topics are interpreted as regular expressions if they
include special regular expression characters. Otherwise, they must be
an exact match. Some examples of regular expressions within topics are
included in <a class="reference internal" href="#table-pub-sub-regex"><span class="std std-ref">Table 3.1</span></a>.</p>
<table border="1" class="docutils" id="table-pub-sub-regex">
<colgroup>
<col width="34%" />
<col width="66%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><strong>Topic</strong></th>
<th class="head"><strong>Behavior</strong></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">^trade$</span></code></td>
<td>matches only “trade”.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">^client.*</span></code></td>
<td>matches “client”, “clients”, “client001”, etc.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">.*trade.*</span></code></td>
<td>matches “NYSEtrades”, “ICEtrade”, etc.</td>
</tr>
</tbody>
</table>
<p><strong>Table 3.1:</strong> <em>Topic Regular Expression Examples</em></p>
<p>For more information regarding the regular expression syntax supported
within AMPS, please see the <em>Regular Expression</em> chapter in the <em>AMPS
User Guide</em>.</p>
<p>AMPS can be configured to disallow regular expression topic matching for
subscriptions. See the <em>AMPS Configuration Guide</em> for details.</p>
</div>
</div>
<div class="section" id="filtering-subscriptions-by-content">
<span id="pub-sub-content"></span><h2>Filtering Subscriptions By Content<a class="headerlink" href="#filtering-subscriptions-by-content" title="Permalink to this headline">¶</a></h2>
<p>One thing that differentiates AMPS from classic messaging systems is its
ability to route messages based on message content. Instead of a
publisher declaring metadata describing the message for downstream
consumers, the publisher can simply publish the message content to AMPS
and let AMPS examine the native message content to determine how best to
deliver the message.</p>
<p>The ability to use content filters greatly reduces the problem of
oversubscription that occurs when topics are the only facility for
subscribing to message content. The topic space can be kept simple and
content filters used to deliver only the desired messages. The topic
space can reflect broad categories of messages and does not have to be
polluted with metadata that is usually found in the content of the
message. In addition, many of the advanced features of AMPS such as
out-of-focus messaging, aggregation, views, and SOW topics rely on the
ability to filter content.</p>
<p>Content-based messaging is somewhat analogous to database queries that
include a <code class="docutils literal"><span class="pre">WHERE</span></code> clause. Topics can be considered tables into which
rows are inserted (or updated). A subscription is similar to issuing a
<code class="docutils literal"><span class="pre">SELECT</span></code> from the topic table with a <code class="docutils literal"><span class="pre">WHERE</span></code> clause to limit the
rows which are returned. Topic-based messaging is analogous to a
<code class="docutils literal"><span class="pre">SELECT</span></code> on a table with no limiting <code class="docutils literal"><span class="pre">WHERE</span></code> clause.</p>
<p>AMPS uses a combination of XPath-based identifiers and SQL-92 operators
for content filtering. Some examples are shown below:</p>
<div class="section" id="example-filter-for-a-json-message">
<h3>Example Filter for a JSON message:<a class="headerlink" href="#example-filter-for-a-json-message" title="Permalink to this headline">¶</a></h3>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span><span class="p">(</span><span class="o">/</span><span class="n">Order</span><span class="o">/</span><span class="n">Instrument</span><span class="o">/</span><span class="n">Symbol</span> <span class="o">==</span> <span class="s1">&#39;IBM&#39;</span><span class="p">)</span> <span class="n">AND</span>
<span class="p">(</span><span class="o">/</span><span class="n">Order</span><span class="o">/</span><span class="n">Px</span> <span class="o">&gt;=</span> <span class="mf">90.00</span> <span class="n">AND</span> <span class="o">/</span><span class="n">Order</span><span class="o">/</span><span class="n">Px</span> <span class="o">&lt;</span> <span class="mf">91.00</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="example-filter-for-an-xml-message">
<h3>Example Filter for an XML Message:<a class="headerlink" href="#example-filter-for-an-xml-message" title="Permalink to this headline">¶</a></h3>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span><span class="p">(</span><span class="o">/</span><span class="n">FIXML</span><span class="o">/</span><span class="n">Order</span><span class="o">/</span><span class="n">Instrmt</span><span class="o">/</span><span class="nd">@Sym</span> <span class="o">==</span> <span class="s1">&#39;IBM&#39;</span><span class="p">)</span> <span class="n">AND</span>
<span class="p">(</span><span class="o">/</span><span class="n">FIXML</span><span class="o">/</span><span class="n">Order</span><span class="o">/</span><span class="nd">@Px</span> <span class="o">&gt;=</span> <span class="mf">90.00</span> <span class="n">AND</span> <span class="o">/</span><span class="n">FIXML</span><span class="o">/</span><span class="n">Order</span><span class="o">/</span><span class="nd">@Px</span> <span class="o">&lt;</span> <span class="mf">91.0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="example-filter-for-a-fix-message">
<h3>Example Filter for a FIX Message:<a class="headerlink" href="#example-filter-for-a-fix-message" title="Permalink to this headline">¶</a></h3>
<div class="code XML highlight-default"><div class="highlight"><pre><span></span><span class="o">/</span><span class="mi">35</span> <span class="o">&lt;</span> <span class="mi">10</span> <span class="n">AND</span> <span class="o">/</span><span class="mi">34</span> <span class="o">==</span> <span class="o">/</span><span class="mi">9</span>
</pre></div>
</div>
<p>For more information about how content is handled within AMPS and the
syntax of AMPS filters, check out <a class="reference external" href="../../../user-guide/html/chapters/amps_expressions.html">AMPS Expressions</a> in the <a class="reference external" href="../../../user-guide/html/index.html">AMPS User Guide</a>.</p>
<table border="1" class="docutils">
<colgroup>
<col width="12%" />
<col width="88%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><img alt="tip" src="../_images/tip.svg" /></td>
<td><p class="first">Unlike some other messaging systems, AMPS lets you use a
relatively small set of topics to categorize messages at a high
level and use content filters to retrieve specific data
published to those topics. Examples of good, broad topic
choices:</p>
<p><code class="docutils literal"><span class="pre">trades</span></code>, <code class="docutils literal"><span class="pre">positions</span></code>, <code class="docutils literal"><span class="pre">MarketData</span></code>, <code class="docutils literal"><span class="pre">Europe</span></code>, <code class="docutils literal"><span class="pre">alerts</span></code></p>
<p class="last">This approach makes it easier to administer AMPS, easier for
publishers to decide which topics to publish to, and easier for
subscribers to be sure that they&#8217;ve subscribed to all relevant
topics.</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>


          </div>
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2019, 60East Technologies, Inc..
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.5.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
    </div>

    

    
  </body>
</html>